# .github/workflows/main.yml

name: CI/CD Pipeline

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # –ò—Å–ø–æ–ª—å–∑—É–µ–º LTS-–≤–µ—Ä—Å–∏—é Node.js
          cache: 'npm' # –ö–µ—à–∏—Ä—É–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

      - name: Install Dependencies
        run: npm install

      # ==================================
      # –®–∞–≥ 1: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –°–±–æ—Ä–∫–∞ (Build)
      # ==================================
      - name: Linting and Build Test
        run: |
          # –í –±—É–¥—É—â–µ–º –∑–¥–µ—Å—å –±—É–¥—É—Ç ESLint –∏ unit-—Ç–µ—Å—Ç—ã.
          # –°–µ–π—á–∞—Å –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è
          npm run build || true # –î–æ–±–∞–≤–ª–µ–Ω–æ '|| true' –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –ø–∞–¥–µ–Ω–∏—è
                                # —Ç–∞–∫ –∫–∞–∫ —É –Ω–∞—Å –Ω–µ—Ç script 'build' –≤ package.json

      # ==================================
      # –®–∞–≥ 2: –î–µ–ø–ª–æ–π –Ω–∞ Vercel (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ)
      # ==================================
      - name: Deploy to Vercel
        uses: amondnet/vercel-action@v25
        if: success() # –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —à–∞–≥–∏ —É—Å–ø–µ—à–Ω—ã
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }} # –¢–æ–∫–µ–Ω –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }} # ID –≤–∞—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }} # ID –ø—Ä–æ–µ–∫—Ç–∞
          github-token: ${{ secrets.GITHUB_TOKEN }} # –¢–æ–∫–µ–Ω GitHub

### 3. –ö–æ–º–º–∏—Ç
–ù–∞–∂–º–∏—Ç–µ **Commit new file** (–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª).

---

## –®–ê–ì 8.1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –°–µ–∫—Ä–µ—Ç–æ–≤ Vercel –≤ GitHub üîë

–ß—Ç–æ–±—ã GitHub Action –º–æ–≥ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç, –µ–º—É –Ω—É–∂–Ω—ã –∫–ª—é—á–∏, –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É—é—â–∏–µ Vercel. –≠—Ç–∏ –∫–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ **Secrets** (–°–µ–∫—Ä–µ—Ç—ã) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ Vercel Keys

–î–ª—è —ç—Ç–æ–≥–æ —à–∞–≥–∞ –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å **—Ç—Ä–∏ ID** –∏–∑ Vercel.

1.  –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –≤–∞—à –ø—Ä–æ–µ–∫—Ç **`quantum-habits-bot-v2`** –Ω–∞ Vercel.
2.  –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** (–ù–∞—Å—Ç—Ä–æ–π–∫–∏) ‚Üí **General** (–û–±—â–∏–µ).
3.  –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –¥–æ —Ä–∞–∑–¥–µ–ª–∞ **Project Settings**. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ:
    * **Project ID**
    * **Org ID** (–û–Ω –∂–µ **Team ID**, –µ—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Team)

–í–∞–º —Ç–∞–∫–∂–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è **Vercel Access Token**:
1.  –í –ü–∞–Ω–µ–ª–∏ Vercel –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å–≤–æ–π **–∞–≤–∞—Ç–∞—Ä/–ø—Ä–æ—Ñ–∏–ª—å** ‚Üí **Settings** (–ù–∞—Å—Ç—Ä–æ–π–∫–∏).
2.  –í –º–µ–Ω—é —Å–ª–µ–≤–∞ –≤—ã–±–µ—Ä–∏—Ç–µ **Tokens** (–¢–æ–∫–µ–Ω—ã).
3.  –ù–∞–∂–º–∏—Ç–µ **Create** (–°–æ–∑–¥–∞—Ç—å).
4.  **Name:** `github_ci_deploy`.
5.  –ù–∞–∂–º–∏—Ç–µ **Create Token** –∏ **—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ—è–≤–∏–≤—à–∏–π—Å—è –¢–æ–∫–µ–Ω** (–µ–≥–æ –ø–æ–∫–∞–∂—É—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!).

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –°–µ–∫—Ä–µ—Ç–æ–≤ –≤ GitHub

1.  –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ GitHub –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É **Settings** (–ù–∞—Å—Ç—Ä–æ–π–∫–∏).
2.  –í –º–µ–Ω—é —Å–ª–µ–≤–∞ –≤—ã–±–µ—Ä–∏—Ç–µ **Secrets and variables** ‚Üí **Actions**.
3.  –ù–∞–∂–º–∏—Ç–µ **New repository secret** (–ù–æ–≤—ã–π —Å–µ–∫—Ä–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è) –∏ –¥–æ–±–∞–≤—å—Ç–µ **—á–µ—Ç—ã—Ä–µ** —Å–µ–∫—Ä–µ—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—è —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

| Secret Name (–ò–º—è) | Secret Value (–ó–Ω–∞—á–µ–Ω–∏–µ) |
| :--- | :--- |
| **`VERCEL_TOKEN`** | –í–∞—à —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π **Vercel Access Token** |
| **`VERCEL_ORG_ID`** | –í–∞—à —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π **Org ID** |
| **`VERCEL_PROJECT_ID`** | –í–∞—à —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π **Project ID** |

---

## –®–ê–ì 8.2: –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ê–≤—Ç–æ–¥–µ–ø–ª–æ–µ–≤ –≤ Vercel (–ö—Ä–∏—Ç–∏—á–Ω–æ) üõë

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ GitHub –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–µ–ø–ª–æ–µ–º, –º—ã –¥–æ–ª–∂–Ω—ã –æ—Ç–∫–ª—é—á–∏—Ç—å Vercel –æ—Ç –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ GitHub –Ω–∞–ø—Ä—è–º—É—é.

1.  –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –≤–∞—à –ø—Ä–æ–µ–∫—Ç **`quantum-habits-bot-v2`** –Ω–∞ Vercel.
2.  –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** (–ù–∞—Å—Ç—Ä–æ–π–∫–∏) ‚Üí **Git**.
3.  –í —Ä–∞–∑–¥–µ–ª–µ **Git Integration** –Ω–∞–π–¥–∏—Ç–µ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.
4.  –°–Ω–∏–º–∏—Ç–µ –≥–∞–ª–æ—á–∫—É —Å –æ–ø—Ü–∏–∏ **Enable Automatic Deployment** –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–ø–ª–æ–∏.

---

**–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞:**
1.  –§–∞–π–ª **`.github/workflows/main.yml`** —Å–æ–∑–¥–∞–Ω.
2.  **–ß–µ—Ç—ã—Ä–µ —Å–µ–∫—Ä–µ—Ç–∞ Vercel** (–≤–∫–ª—é—á–∞—è `VERCEL_TOKEN`) –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ **GitHub Secrets**.
3.  **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–ø–ª–æ–∏** –Ω–∞ Vercel **–æ—Ç–∫–ª—é—á–µ–Ω—ã**.
